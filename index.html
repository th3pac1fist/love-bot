<script>
    async function startChat() {
        const apiKey = document.getElementById("apiKey").value;
        if (!apiKey) {
            alert("Please enter your OpenAI API Key.");
            return;
        }

        const genderPreference = prompt("Would you like to go on a date with a male or female personality?");
        const initialMessage = {
            role: "system",
            content: `You are a ${genderPreference} personality for a blind date.`
        };

        const chatbox = document.getElementById("chatbox");
        chatbox.style.display = "block";

        const messages = document.getElementById("messages");
        messages.innerHTML += `<div>User: ${initialMessage.content}</div>`;
    }

    async function sendMessage() {
        const userInput = document.getElementById("userInput").value;
        const apiKey = document.getElementById("apiKey").value;

        const messages = document.getElementById("messages");
        messages.innerHTML += `<div>User: ${userInput}</div>`;

        const data = {
            messages: [
                { role: "user", content: userInput }
            ]
        };

        const response = await fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
                "Authorization": `Bearer ${apiKey}`,
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        const botMessage = result.choices[0].message.content;

        messages.innerHTML += `<div>Bot: ${botMessage}</div>`;
        document.getElementById("userInput").value = ""; // Clear the input field
    }
</script>
